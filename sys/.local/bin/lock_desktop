#!/usr/bin/env sh
# Launch session lock

# locker script that uses xss-lock, dunst and i3lock.
# inspired by https://github.com/Awan/lockme/blob/master/lockme

_message="Screen will lock in 1 minute"
_notification=60
_timeout=480
_locker="$(readlink -f "$0")"

# load color for background
_color=$(decorate_load_xcolors 'color4' '#545454')

case "$1" in
    start)
        xset s $_timeout $_notification
        xset dpms $(($_timeout * 3)) $(($_timeout * 4)) $(($_timeout * 5))
        exec xss-lock -n "dunstify '$_message'" -l $_locker lock +resetsaver
        ;;
    lock)
        i3lock --color=$_color -e
        sleep 5 && pgrep i3lock && xset dpms force off
        ;;
esac
